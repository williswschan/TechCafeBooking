<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TechCafe Booking Portal</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- External CSS Files -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/main.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/time-slots.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/modals.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/footer.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/responsive.css') }}">
</head>
<body>
    <div class="container">
        <div class="header">
            <h1><i class="fas fa-calendar-check"></i> TechCafe Booking Portal</h1>
            <p>Book your preferred time slot for today and upcoming days</p>
            <button id="kioskBtn" class="kiosk-btn" onclick="toggleKioskMode()">
                <i class="fas fa-desktop"></i>
                <span>Kiosk</span>
            </button>
            <button id="adminBtn" class="admin-btn" onclick="showAdminModal()">
                <i class="fas fa-user-shield"></i>
                <span>Admin</span>
            </button>
        </div>

        <!-- Scrollable Content Area -->
        <div class="scrollable-content">
            <div class="date-selector">
                <div class="date-tabs">
                    {% for date in dates %}
                    <div class="date-tab {% if loop.first %}active{% endif %}" 
                         data-date="{{ date.date }}" 
                         onclick="selectDate('{{ date.date }}', this)">
                        <div>{{ date.display.split('<br>')[0] }}</div>
                        <div style="font-size: 0.8rem; opacity: 0.8;">{{ date.display.split('<br>')[1] }}</div>
                    </div>
                    {% endfor %}
                </div>
            </div>

            <div class="booking-grid">
            <div class="loading" id="loading">
                <div class="spinner"></div>
                <div>Loading bookings...</div>
            </div>
            <div id="timeSlots">
                <!-- Morning Section (09:00-12:00) -->
                <div class="time-section">
                    <div class="section-header">
                        <div class="section-divider"></div>
                        <div class="section-title">
                            <i class="fas fa-sun"></i> Morning Slots (09:00 - 12:00)
                        </div>
                    </div>
                    <div class="time-slots" id="morningSlots">
                        {% for slot in morning_slots %}
                        <div class="time-slot available" 
                             data-time="{{ slot }}">
                            <div class="time-text">{{ slot }}</div>
                            <div class="booked-text" style="display: none;">Available</div>
                        </div>
                        {% endfor %}
                    </div>
                </div>

                <!-- Lunch Break -->
                <div class="lunch-break">
                    <i class="fas fa-utensils"></i>
                    <div class="lunch-break-text">Lunch Break (12:00 - 14:00)</div>
                </div>

                <!-- Afternoon Section (14:00-18:00) -->
                <div class="time-section">
                    <div class="section-header">
                        <div class="section-divider"></div>
                        <div class="section-title">
                            <i class="fas fa-moon"></i> Afternoon Slots (14:00 - 18:00)
                        </div>
                    </div>
                    <div class="time-slots" id="afternoonSlots">
                        {% for slot in afternoon_slots %}
                        <div class="time-slot available" 
                             data-time="{{ slot }}">
                            <div class="time-text">{{ slot }}</div>
                            <div class="booked-text" style="display: none;">Available</div>
                        </div>
                        {% endfor %}
                    </div>
                </div>
            </div>
            </div> <!-- End scrollable-content -->
            
            <!-- Red Footer Section -->
            <div class="footer-section">
                <div class="footer-content">
                    <div class="footer-scroll-text">
                        <small>Connecting Market East & West | AI-Powered Booking Solution</small>
                    </div>
                </div>
            </div>
            
        </div>
    </div>

    <!-- Booking Modal -->
    <div id="bookingModal" class="modal">
        <div class="modal-content">
            <h3><i class="fas fa-user-plus"></i> Book Your Slot</h3>
            <p class="privacy-notice"><strong>⚠️ Your name will be shown publicly. Leave empty for privacy.</strong></p>
            <div class="typeahead-container">
                <input type="text" id="usernameInput" placeholder="Enter your name (optional)" maxlength="50" autocomplete="off">
                <div id="typeaheadDropdown" class="typeahead-dropdown"></div>
            </div>
            <div class="modal-buttons">
                <button class="btn btn-primary" onclick="confirmBooking()">Confirm Booking</button>
                <button class="btn btn-secondary" onclick="closeModal()">Cancel</button>
            </div>
            <div class="clear-saved-info">
                <button class="btn btn-clear" onclick="clearSavedUsername()">
                    <i class="fas fa-trash-alt"></i> Clear Saved Name
                </button>
            </div>
        </div>
    </div>

    <!-- Admin Management Modal -->
    <div id="adminManagementModal" class="modal">
        <div class="modal-content">
            <h3><i class="fas fa-tools"></i> IT Support - Booking Management</h3>
            <p id="adminBookingInfo">Booking: <span id="adminBookingUser"></span> - <span id="adminBookingDateTime"></span><br><br>What action would you like to take?<br><br></p>
            <div class="modal-buttons admin-buttons">
                <button class="btn btn-success" onclick="showAdminCaseCompletedConfirmation()" title="IT support successfully resolved the user's issue">
                    <i class="fas fa-check-circle"></i> Case Completed - Free Slot
                </button>
                <button class="btn btn-danger" onclick="showAdminCancelConfirmation()" title="Remove this booking (user no-show, etc.)">
                    <i class="fas fa-times-circle"></i> Cancel Booking
                </button>
                <button class="btn btn-secondary" onclick="closeModal()" title="Close without making changes">
                    <i class="fas fa-times"></i> Close
                </button>
            </div>
        </div>
    </div>

    <!-- Regular Cancel Modal (for non-admin users) -->
    <div id="cancelModal" class="modal">
        <div class="modal-content">
            <h3><i class="fas fa-user-times"></i> Cancel Booking</h3>
            <p>Are you sure you want to cancel this booking?<br><br></p>
            <div class="modal-buttons">
                <button class="btn btn-danger" onclick="confirmCancellation()">Yes, Cancel</button>
                <button class="btn btn-secondary" onclick="closeModal()">No, Keep Booking</button>
            </div>
        </div>
    </div>

    <!-- Admin Cancel Confirmation Modal -->
    <div id="adminCancelModal" class="modal">
        <div class="modal-content">
            <h3><i class="fas fa-tools"></i> IT Support - Confirm Cancellation</h3>
            <p>Are you sure you want to cancel this booking?<br><br>This action cannot be undone.<br><br></p>
            <div class="modal-buttons">
                <button class="btn btn-danger" onclick="confirmCancellation()">Yes, Cancel Booking</button>
                <button class="btn btn-secondary" onclick="closeModal()">No, Keep Booking</button>
            </div>
        </div>
    </div>

    <!-- Admin Case Completed Confirmation Modal -->
    <div id="adminCaseCompletedModal" class="modal">
        <div class="modal-content">
            <h3><i class="fas fa-tools"></i> IT Support - Confirm Case Completion</h3>
            <p>Are you sure you want to mark this case as completed?<br><br>The slot will be freed up for new bookings.<br><br></p>
            <div class="modal-buttons">
                <button class="btn btn-success" onclick="markCaseCompleted()">Yes, Mark as Completed</button>
                <button class="btn btn-secondary" onclick="closeModal()">No, Keep Booking</button>
            </div>
        </div>
    </div>

    <!-- Admin Password Modal -->
    <div id="adminModal" class="modal">
        <div class="modal-content">
            <h3><i class="fas fa-user-shield"></i> Admin Access</h3>
            <p>Enter admin password:</p>
            <br><br>
            <input type="password" id="adminPasswordInput" placeholder="Enter admin password" maxlength="50">
            <br><br>
            <div class="modal-buttons">
                <button class="btn btn-primary" onclick="verifyAdminPassword()">Access Admin</button>
                <button class="btn btn-secondary" onclick="closeModal()">Cancel</button>
            </div>
        </div>
    </div>

    <script>
        // ...existing JavaScript code from backup file...
    </script>
</body>
</html>
